We consider multiuser scheduling in wireless networks with channel variations and flow-level dynamics. Recently, it has been shown that the MaxWeight algorithm, which is throughput-optimal in networks with a fixed number of users, fails to achieve the maximum throughput in the presence of flow-level dynamics. In this paper, we propose a new algorithm, calledWorkload-based Scheduling with Learning, which is provably throughput-optimal, requires no prior knowledge of channels and user demands, and performs significantly better than previously suggested algorithms.