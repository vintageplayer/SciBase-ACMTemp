Algorithms for on-the-fly garbage collection