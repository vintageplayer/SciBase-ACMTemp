Query optimization on local area networks