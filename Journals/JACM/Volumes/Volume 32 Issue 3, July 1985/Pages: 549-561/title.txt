Optimal attack and reinforcement of a network