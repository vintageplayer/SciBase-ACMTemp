On compiling queries in recursive first-order databases